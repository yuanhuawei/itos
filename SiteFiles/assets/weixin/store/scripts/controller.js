var controller={};controller.isLoading=!0,controller.storeID=utilService.getUrlVar("storeID"),controller.parentID=utilService.getUrlVar("parentID"),controller.categoryID=utilService.getUrlVar("categoryID"),controller.storeItemID=utilService.getUrlVar("storeItemID"),controller.wxOpenID=utilService.getUrlVar("wxOpenID"),controller.isPoweredBy=!1,controller.poweredBy="",controller.title="",controller.contentInfoList=[],controller.render=function(){utilService.render("controller",controller),$("#loading").hide(),$("#main").show()},controller.main=function(){service.getStoreCategory(controller.storeID,controller.wxOpenID,controller.parentID,function(e){controller.isLoading=!1,e.isSuccess?(controller.isPoweredBy=e.isPoweredBy,controller.poweredBy=e.poweredBy,controller.title=e.title,controller.contentInfoList=e.contentInfoList,0==e.contentInfoList.length&&(location.href="store.html?publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID+"&storeID="+controller.storeID+"&categoryID=0"),controller.render()):notifyService.error(e.errorMessage),document.title=e.title})},controller.store=function(){service.getStoreItemList(controller.storeID,controller.categoryID,controller.wxOpenID,function(e){controller.isLoading=!1,e.isSuccess?(controller.isPoweredBy=e.isPoweredBy,controller.poweredBy=e.poweredBy,controller.title=e.title,controller.contentInfoList=e.contentInfoList,controller.render()):notifyService.error(e.errorMessage)})},controller.storeItem=function(){service.getStoreItemInfo(controller.storeID,controller.storeItemID,controller.wxOpenID,function(e){controller.isLoading=!1,e.isSuccess?(controller.isPoweredBy=e.isPoweredBy,controller.poweredBy=e.poweredBy,controller.title=e.title,controller.contentInfo=e.contentInfo,controller.render(),controller.setMap(e.contentInfo.longitude,e.contentInfo.latitude)):notifyService.error(e.errorMessage)})},controller.setMap=function(e,r){map=new BMap.Map("mapContent"),map.enableScrollWheelZoom(!0),map.enableContinuousZoom(),map.centerAndZoom(new BMap.Point(e,r),14),marker=new BMap.Marker(new BMap.Point(e,r)),map.addOverlay(marker)},controller.getStoreListUrl=function(e,r,o){return 0==r?"store.html?publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID+"&storeID="+controller.storeID+"&categoryID="+e:"index.html?publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID+"&parentID="+e+"&storeID="+controller.storeID},controller.getStoreItemUrl=function(e){return"content.html?publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID+"&storeID="+controller.storeID+"&storeItemID="+e},controller.getStoreListReturnUrl=function(e){return e>0&&(controller.storeID=e),"index.html?publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID+"&parentID=0&storeID="+controller.storeID},controller.categoryID?controller.store():controller.storeItemID?controller.storeItem():controller.storeID&&controller.main();