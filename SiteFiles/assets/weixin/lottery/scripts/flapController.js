function isPc(){for(var r=navigator.userAgent,o=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],e=!0,l=0;l<o.length;l++)if(r.indexOf(o[l])>0){e=!1;break}return e}var controller={};controller.isLoading=!0,controller.lotteryID=utilService.getUrlVar("lotteryID"),controller.wxOpenID=utilService.getUrlVar("wxOpenID"),controller.uniqueID=utilService.getUrlVar("uniqueID"),controller.from=utilService.getUrlVar("from"),controller.openLottery=function(){location.href="flap.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID},controller.openApplication=function(){location.href="application.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID+"&lotteryType=flap"},controller.openCheck=function(){location.href="check.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID+"&lotteryType=flap"},controller.openEnd=function(){location.href="end.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID},controller.isEnd=!1,controller.isSuccess=!1,controller.errorMessage="",controller.isPoweredBy=!1,controller.poweredBy="",controller.lotteryInfo={},controller.awardInfoList=[],controller.awardInfo=null,controller.winnerInfo=null,controller.e=null,controller.success=function(){$.layer({area:["auto","auto"],title:"中奖了",dialog:{msg:"恭喜你，中奖了！<br />您抽中了"+controller.awardInfo.awardName+"：<br />"+controller.awardInfo.title,btns:1,type:6,btn:["确定"],yes:function(){controller.openApplication()}}})},controller.failure=function(){layer.msg("很遗憾，您没有中奖哦！<br/>再来一次！",2,5)},controller.render=function(){utilService.render("controller",controller),$(".flap_box a").click(function(){controller.e=this,service.submitLottery(controller.lotteryID,controller.wxOpenID,function(r){controller.isSuccess=r.isSuccess,controller.errorMessage=r.errorMessage,controller.awardInfo=r.awardInfo,controller.winnerInfo=r.winnerInfo,controller.isSuccess?($(controller.e).find(".front").addClass("front_on"),$(controller.e).find(".back").addClass("back_on"),null!=controller.awardInfo&&null!=controller.winnerInfo?($(".flap_box a").unbind("click"),$(controller.e).find(".back").children("img").attr("src","imgFlap/right_flap_bg.png"),$(controller.e).find(".back").children("span").html(controller.awardInfo.awardName),controller.success()):setTimeout(function(){controller.failure()},1e3)):layer.msg(controller.errorMessage,2,5)})}),$("#loading").hide(),$("#main").show()},controller.main=function(){""!=controller.from&&controller.openLottery(),controller.uniqueID||(controller.wxOpenID=controller.uniqueID),service.getLotteryParameter(controller.lotteryID,controller.wxOpenID,function(r){if(controller.isLoading=!1,controller.isEnd=r.isEnd,controller.isSuccess=r.isSuccess,controller.errorMessage=r.errorMessage,controller.isPoweredBy=r.isPoweredBy,controller.poweredBy=r.poweredBy,controller.lotteryInfo=r.lotteryInfo,controller.awardInfoList=r.awardInfoList,controller.awardInfo=r.awardInfo,controller.winnerInfo=r.winnerInfo,null!=controller.winnerInfo){if("Won"==controller.winnerInfo.status&&controller.winnerInfo.cashSN.length<=0)return void controller.openApplication();if("Applied"==controller.winnerInfo.status||"Cashed"==controller.winnerInfo.status)return void controller.openCheck()}1==controller.isEnd?location.href="end.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID:controller.render(),document.title=r.lotteryInfo.title})},controller.main();