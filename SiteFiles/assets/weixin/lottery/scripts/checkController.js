var controller={};controller.isLoading=!0,controller.lotteryID=utilService.getUrlVar("lotteryID"),controller.wxOpenID=utilService.getUrlVar("wxOpenID"),controller.lotteryType=utilService.getUrlVar("lotteryType"),controller.from=utilService.getUrlVar("from"),controller.isSuccess=!1,controller.errorMessage="",controller.isPoweredBy=!1,controller.poweredBy="",controller.lotteryInfo={},controller.awardInfoList=[],controller.awardInfo=null,controller.winnerInfo=null,controller.openLottery=function(){location.href=controller.lotteryType+".html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID},controller.render=function(){utilService.render("controller",controller),$("#qrCode").qrcode({width:90,height:90,text:controller.winnerInfo.cashSN}),$("#loading").hide(),$("#main").show()},controller.main=function(){service.getLotteryParameter(controller.lotteryID,controller.wxOpenID,function(r){""!=controller.from&&(location.href=location.href),controller.isLoading=!1,r.isSuccess&&(controller.isSuccess=r.isSuccess,controller.errorMessage=r.errorMessage,controller.isPoweredBy=r.isPoweredBy,controller.poweredBy=r.poweredBy,controller.lotteryInfo=r.lotteryInfo,controller.awardInfoList=r.awardInfoList,controller.awardInfo=r.awardInfo,controller.winnerInfo=r.winnerInfo,controller.render()),document.title=r.lotteryInfo.title})},controller.main(),controller.submitAwardCode=function(){var r=$("#awardCode").val();controller.lotteryInfo.awardCode!=r?(notifyService.error("对不起，您输入的兑奖密码不正确，请重新输入！"),$("#awardCode").val(""),$("#awardCode").focus()):($("#loading").show(),$("#main").hide(),service.submitAwardCode(controller.lotteryID,controller.winnerInfo.id,function(r){r.isSuccess?(controller.winnerInfo.status="Cashed",controller.render()):notifyService.error(r.errorMessage)}))};