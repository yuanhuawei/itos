function isPc(){for(var o=navigator.userAgent,e=["Android","iPhone","SymbianOS","Windows Phone","iPad","iPod"],r=!0,n=0;n<e.length;n++)if(o.indexOf(e[n])>0){r=!1;break}return r}var controller={};controller.isLoading=!0,controller.lotteryID=utilService.getUrlVar("lotteryID"),controller.wxOpenID=utilService.getUrlVar("wxOpenID"),controller.uniqueID=utilService.getUrlVar("uniqueID"),controller.from=utilService.getUrlVar("from"),controller.openLottery=function(){location.href="yaoyao.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID},controller.openApplication=function(){location.href="application.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID+"&lotteryType=yaoYao"},controller.openCheck=function(){location.href="check.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID+"&lotteryType=yaoYao"},controller.openEnd=function(){location.href="end.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID},controller.isEnd=!1,controller.isSuccess=!1,controller.errorMessage="",controller.isPoweredBy=!1,controller.poweredBy="",controller.lotteryInfo={},controller.awardInfoList=[],controller.awardInfo=null,controller.winnerInfo=null,controller.success=function(){$.layer({area:["auto","auto"],title:"中奖了",dialog:{msg:"恭喜你，中奖了！<br />您摇中了"+controller.awardInfo.awardName+"：<br />"+controller.awardInfo.title,btns:1,type:6,btn:["确定"],yes:function(){controller.openApplication()}}})},controller.failure=function(){layer.msg("很遗憾，您没有中奖哦！<br/>再来一次！",2,5)},controller.render=function(){if(utilService.render("controller",controller),$(".yao_box").click(function(){var o=$(this);$(this).addClass("yao_box_on"),setTimeout(function(){o.removeClass("yao_box_on"),controller.submitLottery()},2e3)}),window.DeviceMotionEvent){var o=25,e=y=z=lastX=lastY=lastZ=0;window.addEventListener("devicemotion",function(){var r=event.accelerationIncludingGravity;e=r.x,y=r.y,(Math.abs(e-lastX)>o||Math.abs(y-lastY)>o)&&($(".yao_box").addClass("yao_box_on"),setTimeout(function(){$(".yao_box").removeClass("yao_box_on"),controller.submitLottery()},2e3)),lastX=e,lastY=y},!1)}$("#loading").hide(),$("#main").show()},controller.submitLottery=function(){service.submitLottery(controller.lotteryID,controller.wxOpenID,function(o){controller.isSuccess=o.isSuccess,controller.errorMessage=o.errorMessage,controller.awardInfo=o.awardInfo,controller.winnerInfo=o.winnerInfo,controller.isSuccess?null!=controller.awardInfo&&null!=controller.winnerInfo?controller.success():controller.failure():layer.msg(controller.errorMessage,2,5)})},controller.main=function(){""!=controller.from&&controller.openLottery(),controller.uniqueID||(controller.wxOpenID=controller.uniqueID),service.getLotteryParameter(controller.lotteryID,controller.wxOpenID,function(o){if(controller.isLoading=!1,controller.isEnd=o.isEnd,controller.isSuccess=o.isSuccess,controller.errorMessage=o.errorMessage,controller.isPoweredBy=o.isPoweredBy,controller.poweredBy=o.poweredBy,controller.lotteryInfo=o.lotteryInfo,controller.awardInfoList=o.awardInfoList,controller.awardInfo=o.awardInfo,controller.winnerInfo=o.winnerInfo,null!=controller.winnerInfo){if("Won"==controller.winnerInfo.status&&controller.winnerInfo.cashSN.length<=0)return void controller.openApplication();if("Applied"==controller.winnerInfo.status||"Cashed"==controller.winnerInfo.status)return void controller.openCheck()}1==controller.isEnd?location.href="end.html?lotteryID="+controller.lotteryID+"&publishmentSystemID="+service.publishmentSystemID+"&wxOpenID="+controller.wxOpenID:controller.render(),document.title=o.lotteryInfo.title})},controller.main();